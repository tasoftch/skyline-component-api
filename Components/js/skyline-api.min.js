!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["skyline-api"]=e():t["skyline-api"]=e()}(window,(function(){return function(t){var e={};function r(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(s,n,function(e){return t[e]}.bind(null,n));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e);var s=window.jQuery?window.jQuery:null;let n=(t,e)=>{t.length>0&&t.forEach(t=>{t.api&&t.api(e)})},i={withCredentials:!0,authenticationHandler:void 0},o={"application/json":t=>{var e=JSON.parse(t.responseText);if(e.success)return e;if(e.errors[0]&&401===e.errors[0].code&&(void 0).settings.authenticationHandler)return(void 0).settings.authenticationHandler.call(void 0,e.errors[0]),!1;throw e.errors[0]},default:t=>t.responseText};class a{constructor(t,e,r){this._settings=Object.assign({},i,e),this._xhr=t,t.withCredentials=!!this._settings.withCredentials,this._target=r,this._successCallbacks=[],this._failCallbacks=[],this._uploadCallbacks=[],this._downloadCallbacks=[],this._doneCallbacks=[],this._buttons=[],this._setupEventHandlers(t),this.responseHandlers=o,this._data=!1}_trigger(t,...e){void 0!==t&&t.length>0&&t.forEach(t=>{t(...e)})}_progress(t,e){var r=0,s=t.loaded||t.position,n=t.total;t.lengthComputable&&(r=Math.ceil(s/n*100)),this._trigger(e,r,s,n,t.lengthComputable)}_load(){let t=this._xhr.getResponseHeader("content-type");try{for(let e in this.responseHandlers)if("default"===e||t.substr(0,e.length).toLowerCase()===e.toLowerCase()){let t,r=this.responseHandlers[e];if("function"==typeof r&&(t=r.call(this,this._xhr))){this._trigger(this._successCallbacks,t);break}throw new Error("Could not parse response.")}}catch(t){this._trigger(this._failCallbacks,t)}this.afterHandler()}_setupEventHandlers(t){t.upload.addEventListener("progress",t=>{this._progress(t,this._uploadCallbacks)}),t.addEventListener("progress",t=>{this._progress(t,this._downloadCallbacks)}),t.addEventListener("load",this._load.bind(this)),t.addEventListener("error",t=>{this._trigger(this._failCallbacks,t)}),t.addEventListener("abort",t=>{this._trigger(this._failCallbacks,t)})}beforeHandler(){n(this._buttons,"start")}afterHandler(){this._trigger(this._doneCallbacks),n(this._buttons,"stop")}send(t){window.setTimeout(()=>{this.beforeHandler();try{t?(this._data=t,this._xhr.send(t)):this._xhr.send()}catch(t){this._trigger(this._failCallbacks,t),this.afterHandler()}},1)}button(t){return"string"==typeof t&&s&&(t=s(idOrBtn)),idOrBtn&&this.buttons.push(t),this}success(t){return t&&"function"==typeof t&&this._successCallbacks.push(t),this}error(t){return t&&"function"==typeof t&&this._failCallbacks.push(t),this}upload(t){return t&&"function"==typeof t&&this._uploadCallbacks.push(t),this}download(t){return t&&"function"==typeof t&&this._downloadCallbacks.push(t),this}done(t){return t&&"function"==typeof t&&this._doneCallbacks.push(t),this}get target(){return this._target}get settings(){return this._settings}get data(){return this._data}}var l,u={setup:{xhr:function(){if(window.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.6.0")}catch(t){try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(t){return console.error("This browser is not AJAX enabled."),null}}},withCredentials:!0,authenticationHandler:void 0},makeTarget:function(t){return/^https?/i.test(t)?t:this.HOST_PREFIX?this.HOST_PREFIX+t:t},get:function(t){let e,r=this.setup.xhr();if(!r)throw new Error("Could not create api call. No XHR instance could be creted.");var s=new a(r,this.setup,e=this.makeTarget(t));return r.open("GET",e),s.send(),s},post:function(t,e){if(!(e instanceof FormData)){var r=new FormData;for(let t in e)e.hasOwnProperty(t)&&r.append(t,e[t]);e=r}let s,n=this.setup.xhr();if(!n)throw new Error("Could not create api call. No XHR instance could be creted.");var i=new a(n,this.setup,s=this.makeTarget(t));return n.open("POST",s),n.send(e),i}};l=window.jQuery,window.Skyline.API=u,l.fn.api=function(t){"start"===t&&this.addClass("api-loading"),"stop"===t&&this.removeClass("api-loading")}}])}));